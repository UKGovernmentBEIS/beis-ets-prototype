{% extends "layouts/admin/base.html" %}

{% set pageID = "representatives" %}

{% block pageTitle %}Representatives {{'- ' + serviceName}}{% endblock %}

{% block content %}


<div class="jui-width-container">

  <main class="govuk-main-wrapper" role="main">
  <h1 class="govuk-heading-l">Representative search results
  </h1>
<table class="govuk-table" data-type="representatives">
        <thead class="govuk-table__head">
          <tr class="govuk-table__row govuk-!-font-size-16">
            <th class="govuk-table__header" scope="col">Representative</th>
            <th class="govuk-table__header" scope="col">Name</th>
            <th class="govuk-table__header " scope="col">Job Title</th>
            <th class="govuk-table__header " scope="col">Contact</th>
            <th class="govuk-table__header govuk-table__header--numeric" scope="col">Status</th>
          </tr>
        </thead>
        <tbody class="govuk-table__body">
          {% if data.newAuthorisedReps %}
          {% for name in data.newAuthorisedReps %}
            <tr class="govuk-table__row govuk-!-font-size-16">
              <th class="govuk-table__cell" scope="row"><a href="#">939-216-693</a>
              </th>
              <td class="govuk-table__cell ">{{ name }}</td>
              <td class="govuk-table__cell ">Account Manager</td> 
              <td class="govuk-table__cell ">joe.brown@blue.com <br />Tel: 07823 423242</td>
              <td class="govuk-table__cell govuk-table__cell--numeric">
                {{ govukTag({
                  text: "approval pending"
                }) }} 
              </td>
            </tr>
          {% endfor %}
          {% endif %}
            {% for ta in data.existingAuthorisedRepresentatives %}
          <tr class="govuk-table__row govuk-!-font-size-16">
              <th class="govuk-table__cell" scope="row"><a href="#">{{ ta.id }}</th>
              <td class="govuk-table__cell ">{{ ta.name }}</td>
              <td class="govuk-table__cell ">{{ ta.jobTitle }}</td>
              <td class="govuk-table__cell ">{{ ta.email }}<br/>Tel: {{ ta.phone }}</td>
              <td class="govuk-table__cell govuk-table__cell--numeric">
              </td>
          </tr>
            {% endfor %}

        </tbody>
      </table>

  </main>

</div>

{% endblock %}
{% block page_scripts %}
<script>
    /* global $ */
    var rejectCommentsBox = '<div class="govuk-form-group">'+
    '<label class="govuk-label" for="more-detail">Why are you rejecting this?</label>'+
    '<span id="more-detail-hint" class="govuk-hint">Please provide a reason.</span>'+
    '<textarea class="govuk-textarea" id="more-detail" name="more-detail" rows="5" aria-describedby="more-detail-hint"></textarea>'+
    '</div>'
    var defaultState = '<div class="accept">'+'<a href="#" role="button" draggable="false" class="govuk-button approve-btn">Approve</a>'+
            '</div><div class="reject">'+
              '<a href="#" role="button" draggable="false" class="govuk-button hmcts-button--secondary reject-btn">Reject</a>'
            '</div>'
    $('body').on( "click", '.govuk-button', function(e) {
        var $taskItem = $(this).parents('.action-container')
        e.preventDefault();
        var approvedTag = '<span class="jui-status  jui-status--new">Approved</span>'
        var rejectedTag = '<span class="jui-status  jui-status--urgent">Rejected</span>'
        var content 
        if ($(this).hasClass('reject-btn')){
            content = rejectCommentsBox + '<a href="#" role="button" draggable="false" class="govuk-button hmcts-button--primary final-reject-btn" style="margin-bottom: 0px;">Reject</a>'+
            '<a href="#" role="button" draggable="false" class="govuk-button govuk-!-margin-left-2 hmcts-button--secondary cancel-btn" style="margin-bottom: 0px;">Cancel</a>'
            $taskItem.find('.action-buttons').html(content)
        }
        if ($(this).hasClass('approve-btn')){
          $taskItem.find('.action-buttons').addClass('approved-transaction').html(approvedTag)
          $taskItem.find('.transfer-completion').show()
        }

        if ($(this).hasClass('final-reject-btn')){
            $taskItem.find('.action-buttons').addClass('approved-transaction').html(rejectedTag)
        }
        if ($(this).hasClass('cancel-btn')){
            $taskItem.find('.action-buttons').html(defaultState)
        }
    });
</script>
{% endblock %}
